#è¿™é‡Œæ˜¯è®¢é˜…æ›´æ–°å’Œå»¶è¿Ÿæµ‹è¯•ç›¸å…³
PProviders: &PProviders 
  è¾“å…¥: http
  interval: 86400
  proxy: è®¢é˜…æ›´æ–° #å¯ä»¥æ›´æ”¹ proxy æŒ‡å®šçš„å‡ºç«™
  header: 
    User-Agent: ["Clash.Meta/mihomo/Alpha/1.19.16"]
  health-check: 
    enable: true
    url: 'https://captive.apple.com'
    interval: 300
  filter: '(?i)^(?!.*(?:å®˜ç½‘|ç¾¤ç»„|å‰©ä½™|å…¬ç›Š|å‘å¸ƒ|DIZTNA|é€šè·¯|å¤‡ç”¨|ç™»å½•|ç¦æ­¢|å®šæ—¶|æ¸ é“|æ›´æ–°|è¿‡æœŸ|ç‰¢è®°|æ°¸ä¹…|åˆ°æœŸ|è¿›ç¾¤|ä½™é¢|å…³æ³¨|é˜ä¸‹|æœ¬ç«™|æ— æ³•|åˆ·æ–°|å¯¼èˆª|âš ï¸|@|Traffic|Expire|http|https|com|\bg\b)).*'
#----------------------------------------------
#å¼•ç”¨è¿œç¨‹è®¢é˜…é“¾æ¥æˆ–è€…æœ¬åœ°æ–‡ä»¶
# urlé‡Œå¡«å†™è‡ªå·±çš„è®¢é˜…,åç§°ä¸èƒ½é‡å¤
proxy-providers:   
  æœºåœºä¸€:
    <<: *PProviders
    url: "æ¢æˆè®¢é˜…é“¾æ¥"
    path: ./proxy_providers/æœºåœºä¸€.yaml
    override: {additional-suffix: '[æœºåœºä¸€]'}
  
   # override: {additional-prefix: '[]'}
   # []å†…å¯ä¸ºèŠ‚ç‚¹åç§°æ·»åŠ å›ºå®šå‰ç¼€
   
   # override: {additional-suffix: '[]'}
   # []å†…å¯ä¸ºèŠ‚ç‚¹åç§°æ·»åŠ å›ºå®šåç¼€
#-----------------------------------------------
proxies:
  - {name: DNS_Hijack, type: dns}
#-----------------------------------------------
# åŸºç¡€é…ç½®
mixed-port: 7890
redir-port: 9797
tproxy-port: 9898
mode: rule           # è¿è¡Œæ¨¡å¼
bind-address: '*'
ipv6: false           # IPv6æ€»å¼€å…³
allow-lan: true       # å…è®¸å±€åŸŸç½‘
unified-delay: false  # ç»Ÿä¸€å»¶è¿Ÿ
tcp-concurrent: true # TCPå¹¶å‘
log-level: error      # æ—¥å¿—ç­‰çº§ silent/error/warning/info/debug
find-process-mode: strict
#  - always, å¼€å¯ï¼Œå¼ºåˆ¶åŒ¹é…æ‰€æœ‰è¿›ç¨‹
#  - strict, é»˜è®¤ï¼Œç”± mihomo åˆ¤æ–­æ˜¯å¦å¼€å¯
#  - off, ä¸åŒ¹é…è¿›ç¨‹ï¼Œæ¨èåœ¨è·¯ç”±å™¨ä¸Šä½¿ç”¨æ­¤æ¨¡å¼
#keep-alive-interval: 1800 
keep-alive-idle: 300
keep-alive-interval: 75
global-client-fingerprint: chrome
#-----------------------------------------------
# ç®¡ç†é¢æ¿é…ç½®
external-controller: 0.0.0.0:9090
external-ui: ./dashboard
external-ui-url: "https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip"
#-----------------------------------------------
# é…ç½®å­˜å‚¨
profile: # å­˜å‚¨ select é€‰æ‹©è®°å½•
  store-selected: true
  # æŒä¹…åŒ– fake-ip
  store-fake-ip: true
#-----------------------------------------------
# å—…æ¢æ¨¡å—
sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: false
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"
#-----------------------------------------------
# ç½‘å¡æ¨¡å—
tun:
  enable: false
  device: meta
  stack: mixed
  dns-hijack: [any:53, tcp://any:53]
  udp-timeout: 300
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true
  strict-route: true
#-----------------------------------------------
# DNSæ¨¡å—
dns:
  enable: true
  ipv6: false
  cache-algorithm: arc
  listen: "[::]:1053"
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-range6: fc00::1/64
  fake-ip-filter:
    - "RULE-SET:Fake-IP-Filter"
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  nameserver-policy:
    "RULE-SET:gfw":
      - "https://dns.google/dns-query#ä»£ç†"
  direct-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
#-----------------------------------------------
# é”šç‚¹ - åœ°åŒºç­›é€‰ç»„
FilterHK: &FilterHK '(?i)æ¸¯|\bhk\b|ğŸ‡­ğŸ‡°|hongkong|hong kong'
FilterSG: &FilterSG '(?i)^(?!.*(?:\bus\b)).*(æ–°åŠ å¡|ç‹®åŸ|\bsg\b|ğŸ‡¸ğŸ‡¬|singapore)'
FilterJP: &FilterJP '(?i)æ—¥æœ¬|\bjp\b|ğŸ‡¯ğŸ‡µ|japan'
FilterUS: &FilterUS '(?i)ç¾|\bus\b|ğŸ‡ºğŸ‡¸|unitedstates|united states'   
FilterOther: &FilterOther '(?i)^(?!.*(?:ğŸ‡­ğŸ‡°|ğŸ‡¹ğŸ‡¼|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¨ğŸ‡³|æ¸¯|å°|æ—¥|ç¾|æ–°|\bhk\b|\btw\b|\bjp\b|\bus\b|\bsg\b|hongkong|taiwan|japan|unitedstates|united states|singapore|\bg\b|æ¬ è´¹|DNS_Hijack)).*' 
# \b ç”¨æ¥åŒ¹é…â€œå•è¯çš„å¼€å¤´æˆ–ç»“å°¾â€
#ç¤ºä¾‹ï¼š\bhk\b åŒ¹é… "hk" ä½†ä¸åŒ¹é… "hks"
#-----------------------------------------------
# é”šç‚¹ - ç­–ç•¥ç»„åŸºç¡€é…ç½®
BaseFB: &BaseFB {type: fallback, interval: 200, lazy: true, url: 'https://captive.apple.com'}
BaseUT: &BaseUT {type: url-test, interval: 200, tolerance: 50, lazy: true, url: 'https://captive.apple.com', hidden: true}
#-----------------------------------------------
#é”šç‚¹ - ç­–ç•¥ç»„ä»£ç†åˆ—è¡¨
SelectPy: &SelectPy {type: select, proxies: [é¦™æ¸¯æ•…è½¬, æ–°åŠ å¡æ•…è½¬, æ—¥æœ¬æ•…è½¬, ç¾å›½æ•…è½¬, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, DIRECT]}
SelectProxy: &SelectProxy {type: select,proxies: [ä»£ç†, é¦™æ¸¯æ•…è½¬, æ–°åŠ å¡æ•…è½¬, æ—¥æœ¬æ•…è½¬, ç¾å›½æ•…è½¬, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, DIRECT]}
#-----------------------------------------------
# ä»£ç†ç­–ç•¥ç»„
proxy-groups:
  #---------------------------------------------
  # ä¸»è¦ç­–ç•¥ç»„
  - {name: ä»£ç†, <<: *SelectPy, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master/IconSet/mini/Proxy.png"}
    
  - {name: Telegram, <<: *SelectProxy, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master/IconSet/mini/Telegram.png"}
    
  - {name: Google, <<: *SelectProxy, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Google.png"}
    
  - {name: Aiå¹³å°, <<: *SelectProxy, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Qure.png"}
  #---------------------------------------------
  #åœ°åŒºç­–ç•¥ç»„                              
  - {name: é¦™æ¸¯æ•…è½¬, <<: *BaseFB, proxies: [é¦™æ¸¯æ‰‹åŠ¨, é¦™æ¸¯è‡ªåŠ¨], icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Hong_Kong.png"}  
  - {name: é¦™æ¸¯æ‰‹åŠ¨, type: select, include-all: true, filter: *FilterHK, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Hong_Kong.png"}
  - {name: é¦™æ¸¯è‡ªåŠ¨, <<: *BaseUT, include-all: true, filter: *FilterHK, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Hong_Kong.png"}
        
  - {name: æ–°åŠ å¡æ•…è½¬, <<: *BaseFB, proxies: [æ–°åŠ å¡æ‰‹åŠ¨, æ–°åŠ å¡è‡ªåŠ¨], icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Singapore.png"}
  - {name: æ–°åŠ å¡æ‰‹åŠ¨, type: select, include-all: true, filter: *FilterSG, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Singapore.png"}
  - {name: æ–°åŠ å¡è‡ªåŠ¨, <<: *BaseUT, include-all: true, filter: *FilterSG, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Singapore.png"}
    
  - {name: æ—¥æœ¬æ•…è½¬, <<: *BaseFB, proxies: [æ—¥æœ¬æ‰‹åŠ¨, æ—¥æœ¬è‡ªåŠ¨], icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Japan.png"}
  - {name: æ—¥æœ¬æ‰‹åŠ¨, type: select, include-all: true, filter: *FilterJP, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Japan.png"}
  - {name: æ—¥æœ¬è‡ªåŠ¨, <<: *BaseUT, include-all: true, filter: *FilterJP, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Japan.png"}
    
  - {name: ç¾å›½æ•…è½¬, <<: *BaseFB, proxies: [ç¾å›½æ‰‹åŠ¨, ç¾å›½è‡ªåŠ¨], icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/United_States.png"}
  - {name: ç¾å›½æ‰‹åŠ¨, type: select, include-all: true, filter: *FilterUS, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/United_States.png"}
  - {name: ç¾å›½è‡ªåŠ¨, <<: *BaseUT, include-all: true, filter: *FilterUS, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/United_States.png"}
  
  - {name: å…¶å®ƒåœ°åŒº, type: select, include-all: true, filter: *FilterOther, icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Area.png"} 
        
  - {name: å…¨éƒ¨èŠ‚ç‚¹, type: select, include-all: true, filter: '(?i)^(?!.*(?:DNS_Hijack)).*', icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Global.png"}  
  #---------------------------------------------
  # å…¶å®ƒç­–ç•¥ç»„
  - {name: è®¢é˜…æ›´æ–°, type: select, proxies: [DIRECT, ä»£ç†], icon: "https://gcore.jsdelivr.net/gh/Koolson/Qure@master//IconSet/mini/Airport.png"}
#-----------------------------------------------
# è·¯ç”±è§„åˆ™
rules:
  - IP-CIDR,95.161.76.100/31,REJECT-DROP,no-resolve
  - DST-PORT,53,DNS_Hijack
  
  - RULE-SET,private,DIRECT
  - RULE-SET,private_ip,DIRECT,no-resolve 
  - RULE-SET,Ai,Aiå¹³å°
  - RULE-SET,telegram,Telegram 
  - RULE-SET,telegram_ip,Telegram  
  - RULE-SET,google,Google     
  - RULE-SET,google_ip,Google 
  - RULE-SET,gfw,ä»£ç† 
  - RULE-SET,cn,DIRECT
  - RULE-SET,cn_ip,DIRECT
  
  # å…œåº•è§„åˆ™ - æœªåŒ¹é…æµé‡
  - MATCH,ä»£ç†
#-----------------------------------------------
# è§„åˆ™é›†é”šç‚¹
rule-anchor:
  dom: &dom {type: http, interval: 86400, behavior: domain, format: yaml}
  cla: &cla {type: http, interval: 86400, behavior: classical, format: yaml}
  
  ip: &ip {type: http, interval: 86400, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 86400, behavior: domain, format: mrs}
#-----------------------------------------------
# è§„åˆ™æä¾›è€…
rule-providers:  
  Ai:  
    <<: *domain
    url: "https://gcore.jsdelivr.net/gh/DustinWin/ruleset_geodata@mihomo-ruleset/ai.mrs"
    path: ./rule_providers/Ai.mrs       
                       
  Fake-IP-Filter:
    <<: *domain
    url: "https://gcore.jsdelivr.net/gh/DustinWin/ruleset_geodata@mihomo-ruleset/fakeip-filter.mrs"  
    path: ./rule_providers/Fake-IP-Filter.mrs     
    
  google:
    <<: *domain
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta//geo/geosite/google.mrs"
    path: ./rule_providers/google.mrs
    
  google_ip:
    <<: *ip
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.mrs"
    path: ./rule_providers/google_ip.mrs
  
  telegram:
    <<: *domain
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs"
    path: ./rule_providers/telegram.mrs  
        
  telegram_ip:
    <<: *ip
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs"
    path: ./rule_providers/telegram_ip.mrs 
  
  private:
    <<: *domain
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.mrs"
    path: ./rule_providers/private.mrs
  
  private_ip:
    <<: *ip
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/private.mrs"  
    path: ./rule_providers/private_ip.mrs
 
  gfw:
    <<: *domain
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/gfw.mrs"
    path: ./rule_providers/gfw.mrs
 
  cn:
    <<: *domain
    url: "https://static-file-global.353355.xyz/rules/cn-additional-list.mrs"
    path: ./rule_providers/cn.mrs
            
  cn_ip:
    <<: *ip
    url: "https://gcore.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs"
    path: ./rule_providers/cn_ip.mrs
